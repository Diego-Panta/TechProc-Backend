{
  "info": {
    "name": "Announcements API - Complete CRUD",
    "description": "Colección completa de endpoints para Announcements incluyendo manejo de views",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "PUBLIC - Sin autenticación",
      "item": [
        {
          "name": "1. GET - Listar announcements públicos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/public?target_page=home&display_type=banner",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "public"],
              "query": [
                {
                  "key": "target_page",
                  "value": "home",
                  "description": "Página objetivo (opcional)",
                  "disabled": true
                },
                {
                  "key": "display_type",
                  "value": "banner",
                  "description": "Tipo de display (opcional)",
                  "disabled": true
                }
              ]
            },
            "description": "Obtiene todos los anuncios activos y publicados. Sin autenticación. Retorna solo announcements con status='published' y dentro de las fechas activas."
          }
        },
        {
          "name": "2. GET - Ver announcement público (incrementa views)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/public/1",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "public", "1"]
            },
            "description": "⭐ IMPORTANTE: Este endpoint INCREMENTA automáticamente el contador de VIEWS cada vez que se consulta.\n\nObtiene un anuncio público específico. Verifica que esté publicado y activo. Cada llamada suma +1 a views."
          }
        }
      ]
    },
    {
      "name": "PROTECTED - Requieren autenticación",
      "item": [
        {
          "name": "3. GET - Listar todos los announcements (admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements?status=published&target_page=home&per_page=15",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements"],
              "query": [
                {
                  "key": "status",
                  "value": "published",
                  "description": "Filtrar por estado (draft, published, archived)",
                  "disabled": true
                },
                {
                  "key": "target_page",
                  "value": "home",
                  "description": "Filtrar por página objetivo",
                  "disabled": true
                },
                {
                  "key": "per_page",
                  "value": "15",
                  "description": "Resultados por página (default: 15)",
                  "disabled": true
                }
              ]
            },
            "description": "Lista TODOS los anuncios (incluyendo drafts y archived). Requiere autenticación y rol developer-web."
          }
        },
        {
          "name": "4. GET - Ver announcement específico (admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/1",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "1"]
            },
            "description": "Obtiene un anuncio específico con todos sus datos. NO incrementa views. Requiere autenticación."
          }
        },
        {
          "name": "5. POST - Crear nuevo announcement",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Nuevo Anuncio Importante\",\n  \"content\": \"Este es el contenido del anuncio. Puede incluir HTML o texto plano.\",\n  \"image_url\": \"https://example.com/images/announcement.jpg\",\n  \"display_type\": \"banner\",\n  \"target_page\": \"home\",\n  \"link_url\": \"https://example.com/more-info\",\n  \"button_text\": \"Más información\",\n  \"status\": \"draft\",\n  \"start_date\": \"2025-01-20T00:00:00Z\",\n  \"end_date\": \"2025-12-31T23:59:59Z\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements"]
            },
            "description": "Crea un nuevo anuncio. El campo 'views' se inicializa automáticamente en 0. El 'created_by' se asigna automáticamente del usuario autenticado."
          }
        },
        {
          "name": "6. PUT - Actualizar announcement (incluye views)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Anuncio Actualizado\",\n  \"content\": \"Contenido modificado del anuncio\",\n  \"status\": \"published\",\n  \"views\": 150\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/1",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "1"]
            },
            "description": "⭐ Actualiza un anuncio existente. PUEDES incluir el campo 'views' para actualizarlo manualmente a cualquier valor."
          }
        },
        {
          "name": "7. DELETE - Eliminar announcement",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/1",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "1"]
            },
            "description": "Elimina un anuncio permanentemente."
          }
        },
        {
          "name": "8. POST - ⭐ RESETEAR VIEWS a 0",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/1/reset-views",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "1", "reset-views"]
            },
            "description": "⭐ ENDPOINT ESPECÍFICO PARA VIEWS: Resetea el contador de vistas a 0 para el anuncio especificado.\n\nRespuesta esperada:\n{\n  \"success\": true,\n  \"message\": \"Vistas reseteadas a 0\",\n  \"views\": 0\n}"
          }
        },
        {
          "name": "9. GET - ⭐ Estadísticas (incluye total views)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/developer-web/announcements/stats/summary",
              "host": ["{{base_url}}"],
              "path": ["api", "developer-web", "announcements", "stats", "summary"]
            },
            "description": "⭐ Obtiene estadísticas completas incluyendo:\n- Total de anuncios\n- Cantidad por status (draft, published, archived)\n- TOTAL DE VIEWS acumuladas de todos los anuncios\n- Cantidad de anuncios activos\n\nRespuesta esperada:\n{\n  \"success\": true,\n  \"data\": {\n    \"total\": 50,\n    \"draft\": 10,\n    \"published\": 35,\n    \"archived\": 5,\n    \"total_views\": 15430,\n    \"active_count\": 20\n  }\n}"
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "token",
      "value": "tu_token_jwt_aqui",
      "type": "string"
    }
  ]
}
